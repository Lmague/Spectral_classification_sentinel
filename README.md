# EuroSAT CNN Classification Project

This project's goal is to use Sentinel-2 satellite imagery to classify land use and land cover.
To do so, we use a **Custom Light ResNet** (Convolutional Neural Network) architecture, HTML/CSS/JS for the frontend, and Python with Flask for the backend.

My goal with this project was to learn more about computer vision, specifically **Residual Networks (ResNet)** and model optimization for CPU inference. It bridges the gap between remote sensing and deep learning, two fields I am passionate about.

---

## Project structure

* `CNN_Training.ipynb` – Notebook used to train the ResNet model (includes Data Augmentation & TFLite conversion)
* `eurosat_resnet_light.tflite` – Optimized quantized model for CPU inference (recommended)
* `CNN_Weights.keras` – Saved full Keras model (for retraining)
* `CNN_EuroSat.py` – Flask backend for inference
* `html_carte.html` – Web interface (Leaflet)
* `css_carte.css` – Stylesheet for the interface
* `js_carte.js` – Frontend logic (zone selection, tiling, API calls)

---

## Dataset

* **EuroSAT**: 27,000 RGB images (64×64 pixels) from Sentinel-2 satellite.
* **10 Classes**: AnnualCrop, Forest, HerbaceousVegetation, Highway, Industrial, Pasture, PermanentCrop, Residential, River, SeaLake.
* **Preprocessing**: Images are normalized ([0,1] range) and resized to ensure consistency.
* **Source**: [TensorFlow Datasets](https://www.tensorflow.org/datasets/catalog/eurosat)

---

## Model Architecture: Light ResNet

Unlike standard sequential models, this project implements a custom **ResNet (Residual Network)** architecture to capture fine-grained textures.

**Key features:**

* **Residual Blocks**: Uses skip connections to prevent the vanishing gradient problem and allow the model to learn deeper features.
* **GELU Activation**: Used instead of ReLU for better convergence.
* **Lightweight Design**:
* Starts with **32 filters** (instead of the standard 64) to reduce computational cost.
* Total parameters: **~700k** (vs 20M+ for standard ResNet50).


* **Data Augmentation**: Integrated directly into the training pipeline (Random Flip, Rotation, Zoom, Contrast) to improve robustness and generalization.

---

## Training & Results

The model was trained for 100 epochs with **EarlyStopping** and **LearningRateScheduler** to ensure stability.

* **Test Accuracy**: **96.85%**
* **Test Loss**: 0.08816

The introduction of Data Augmentation eliminated the overfitting observed in previous iterations, as shown by the convergence of training and validation curves.

---

## Optimization (CPU Inference)

To ensure the web application runs smoothly on standard hardware (without a GPU), the model is converted to **TensorFlow Lite (TFLite)** with quantization:

* **Format**: `.tflite`
* **Optimization**: Dynamic Range Quantization
* **Benefit**: Reduces model size by 4x and significantly speeds up inference time on CPUs, allowing for real-time classification of large map areas.

---

## Web application

The application allows the user to select a rectangle on a Leaflet map and run classification on this area.

1. **Frontend**: Captures the selected geographical bounds.
2. **Tiling**: The area is mathematically sliced into 64x64 pixel tiles corresponding to the Sentinel-2 resolution (~10m/px).
3. **Inference**: The backend receives the batch of tiles and runs predictions using the optimized TFLite model.
4. **Visualization**: Results are aggregated to display the dominant land cover and class distribution percentages.

---

## Installation

1. Clone this repository
2. Install dependencies:
**With pip:**
```bash
python -m venv vision
# Windows:
.\vision\Scripts\Activate.ps1
# Mac/Linux:
source vision/bin/activate

pip install --upgrade pip tensorflow numpy pillow flask flask-cors scikit-learn matplotlib seaborn ipykernel

```


3. **Inference Setup**:
Ensure `eurosat_resnet_light.tflite` is in the root folder (generated by the notebook).
4. Run the backend:
```bash
python CNN_EuroSat.py

```


5. Open the interface in your browser at `http://localhost:5000/`

---

## Author

This project started as an undergraduate final assignment and has evolved into a personal research project on Deep Learning optimization.
Moving from a simple CNN to a ResNet architecture improved accuracy by nearly **5%**, while TFLite quantization made the tool usable in real-world web scenarios.

## Future Improvements

* **Urban Differentiation**: Further improve distinction between "Highway" and "River" using texture-specific augmentation.
* **Client-Side Inference**: Porting the TFLite model to **TensorFlow.js** to run predictions directly in the browser (removing the need for a Python backend).
